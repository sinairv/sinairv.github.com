<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Windows Forms | Sina Iravanian]]></title>
  <link href="http://sinairv.github.io/blog/categories/windows-forms/atom.xml" rel="self"/>
  <link href="http://sinairv.github.io/"/>
  <updated>2015-10-05T00:23:45+11:00</updated>
  <id>http://sinairv.github.io/</id>
  <author>
    <name><![CDATA[Sina Iravanian]]></name>
    <email><![CDATA[sina.iravanian@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Syntax Highlighter for Windows Forms Rich Text Box]]></title>
    <link href="http://sinairv.github.io/blog/2014/12/01/syntax-highlighter-for-windows-forms-rich-text-box/"/>
    <updated>2014-12-01T19:18:48+11:00</updated>
    <id>http://sinairv.github.io/blog/2014/12/01/syntax-highlighter-for-windows-forms-rich-text-box</id>
    <content type="html"><![CDATA[<p>Years ago I created a tool called <a href="http://code4public.codeplex.com">Code4Public</a> to convert source code into HTML called. I was using this tool to put nice code snippets in the blog I used to maintain at that time. The tool is able to get the code, apply syntax highlighting to it based on the syntax of the language selected, and then create HTML based on the theme selected (e.g., MSDN theme). I didn’t assign more time on making the tool better and better, as better ways of doing the same task were emerging, and also other by-products of the tool were becoming more interesting at the time; e.g., <a href="https://github.com/sinairv/YAXLib">YAXLib</a> was a little by-product of Code4Public used to store settings, themes and language syntaxes in XML files.</p>

<p>This post is to introduce yet another by-product of Code4Public: <a href="https://github.com/sinairv/WinFormsSyntaxHighlighter">WinFormsSyntaxHighlighter</a>. This library enables syntax highlighting on a <code>RichTextBox</code> based on patterns that the developer defines.</p>

<p>The syntax highlighter hooks into <code>RichTextBox</code> events in the constructor.</p>

<p><code>csharp
var syntaxHighlighter = new SyntaxHighlighter(theRichTextBox);
</code></p>

<p>That’s it. Now I need to define patterns and colors. For example I want to see <code>for</code>, <code>foreach</code>, <code>int</code> and <code>var</code> in blue:</p>

<p><code>csharp
// 1st set of keywords; I'd like to see them in Blue
syntaxHighlighter.AddPattern(
    new PatternDefinition("for", "foreach", "int", "var"), 
    new SyntaxStyle(Color.Blue));
</code></p>

<p>I can also define whether I want to see a pattern in <em>bold</em> or <em>italics</em>. For example I want to see <code>public</code>, <code>partial</code>, <code>class</code>, and <code>void</code> in bold navy but not italics. I want the match these words case-insensitively, so that <code>PuBlIc</code> will be shown in navy blue as well. Note that this is an imaginary syntax for demonstration purposes only:</p>

<p><code>csharp
// 2nd set of keywords; I'd like to see them in bold Navy, and they must be case insensitive
syntaxHighlighter.AddPattern(
    new CaseInsensitivePatternDefinition("public", "partial", "class", "void"), 
    new SyntaxStyle(Color.Navy, bold: true, italic: false));
</code></p>

<p>I can also define the patterns directly with regular expression:</p>

<p><code>csharp
// numbers; I'd like to see them in purple
syntaxHighlighter.AddPattern(
    new PatternDefinition(@"\d+\.\d+|\d+"), 
    new SyntaxStyle(Color.Purple));
</code></p>

<p>Since the input string is partitioned by the patterns defined in the order of their definition, they must be added in the proper order. E.g., I want to see numbers in purple, but not those numbers inside a comment or inside a string. So the pattern definition for a comment block must be added first, then the pattern for string literal, and at last the pattern for numbers. The following is a more complete example from the beginning to the end.</p>

<p>```csharp
var syntaxHighlighter = new SyntaxHighlighter(theRichTextBox);</p>

<p>// That’s it. Now tell me how you’d like to see what…</p>

<p>// multi-line comments; I’d like to see them in dark-sea-green and italic
syntaxHighlighter.AddPattern(
    new PatternDefinition(new Regex(@”/*(.|[\r\n])*?*/”, 
        RegexOptions.Multiline | RegexOptions.Compiled)), 
    new SyntaxStyle(Color.DarkSeaGreen, bold: false, italic: true));</p>

<p>// singlie-line comments; I’d like to see them in Green and italic
syntaxHighlighter.AddPattern(
    new PatternDefinition(new Regex(@”//.*?$”, 
        RegexOptions.Multiline | RegexOptions.Compiled)), 
    new SyntaxStyle(Color.Green, bold: false, italic: true));</p>

<p>// double quote strings; I’d like to see them in Red
syntaxHighlighter.AddPattern(
    new PatternDefinition(@”"”([^””]|"”"”)+"””), 
    new SyntaxStyle(Color.Red));</p>

<p>// single quote strings; I’d like to see them in Salmon 
syntaxHighlighter.AddPattern(
    new PatternDefinition(@”'([^’]|'')+'”), 
    new SyntaxStyle(Color.Salmon));</p>

<p>// 1st set of keywords; I’d like to see them in Blue
syntaxHighlighter.AddPattern(
    new PatternDefinition(“for”, “foreach”, “int”, “var”), 
    new SyntaxStyle(Color.Blue));</p>

<p>// 2nd set of keywords; I’d like to see them in bold Navy, and they must be case insensitive
syntaxHighlighter.AddPattern(
    new CaseInsensitivePatternDefinition(“public”, “partial”, “class”, “void”), 
    new SyntaxStyle(Color.Navy, true, false));</p>

<p>// numbers; I’d like to see them in purple
syntaxHighlighter.AddPattern(
    new PatternDefinition(@”\d+.\d+|\d+”), 
    new SyntaxStyle(Color.Purple));</p>

<p>// operators; I’d like to see them in Brown
syntaxHighlighter.AddPattern(
    new PatternDefinition(“+”, “-“, “&gt;”, “&lt;”, “&amp;”, “|”), 
    new SyntaxStyle(Color.Brown));
``` </p>

<p>Please also note that, nobody can model a whole language like C# or Java with regular expressions, because these languages are not regular. So this tool is by no means a complete and error-free way of modeling languages. Use this just for simple key-word matching or pattern matching and coloring them as you like; but don’t expect too much.</p>

<p><a href="https://github.com/sinairv/WinFormsSyntaxHighlighter">WinFormsSyntaxHighlighter</a> is hosted in GitHub and is licensed under MIT.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Code Snippet for Dealing With Windows Forms ListView Control in Details Mode]]></title>
    <link href="http://sinairv.github.io/blog/2011/05/09/code-snippet-for-dealing-with-windows-forms-listview-control-in-details-mode/"/>
    <updated>2011-05-09T00:39:37+10:00</updated>
    <id>http://sinairv.github.io/blog/2011/05/09/code-snippet-for-dealing-with-windows-forms-listview-control-in-details-mode</id>
    <content type="html"><![CDATA[<p>I needed a piece of code to manage list-view controllers. I needed to use <code>ListView</code> controls in the details mode, which automatically sort its contents when I click on the header, and also pastes the content in a tabular format when I press <code>Ctrl</code>+<code>C</code> or <code>Ctrl</code>+<code>Insert</code> on it. So I created the following classes. The code that carries out the sorting stuff when the header is clicked is taken from <a href="http://msdn.microsoft.com/en-us/library/ms996467.aspx">this</a> following MSDN article.</p>

<p>So these are the contributions of these pieces of code: 1) Sort <code>ListView</code> items when the column header is clicked, 2) Paste the contents of the <code>ListView</code> control to clipboard in a tabular format, and 3) Provide an easy to use API to append data to a <code>ListView</code> control.</p>

<p>The following gist contains the code to accomplish this. It consists of 3 files. The <code>ListViewColumnSorter.cs</code> file is responsible for the sorting stuff. The <code>ListViewUtils.cs</code> file provides the utility methods for a ListView control. The main methods that perform the job are located in the <code>ListViewUtils</code> class. The two needed methods are <code>InitListView</code> and <code>AppendToListView</code>. And finally the <code>Usage.cs</code> file provides a small demo of the utility methods.</p>

<script src="https://gist.github.com/sinairv/2693729.js"></script>

]]></content>
  </entry>
  
</feed>
